"use strict";function ownKeys(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,i)}return t}function _objectSpread(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(t,!0).forEach(function(e){_defineProperty(r,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ownKeys(t).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})}return r}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var express=require("express"),cors=require("cors"),_require=require("uuidv4"),uuid=_require.uuid,isUuid=_require.isUuid,app=express();app.use(express.json()),app.use(cors());var repositories=[];function validateRepositoryId(e,r,t){var i=e.params.id;return isUuid(i)?t():r.status(400).json({error:"Invalid Repository ID!"})}app.use("/repositories/:id",validateRepositoryId),app.get("/repositories",function(e,r){return r.json(repositories)}),app.post("/repositories",function(e,r){var t=e.body,i=t.title,o=t.url,s=t.techs,n={id:uuid(),title:i,url:o,techs:s,likes:0};return repositories.push(n),r.json(n)}),app.put("/repositories/:id",function(e,r){var t=e.params.id,i=e.body,o=i.title,s=i.url,n=i.techs,p=repositories.findIndex(function(e){return e.id===t});if(p<0)return r.status(400).json({error:"Repository Not Found!"});repo=repositories[p];var u=_objectSpread({},repo,{url:s,title:o,techs:n});return repositories[p]=u,r.json(u)}),app.delete("/repositories/:id",function(e,r){var t=e.params.id,i=repositories.findIndex(function(e){return e.id===t});return i<0?r.status(400).json({error:"Repository Not Found!"}):(repositories.splice(i,1),r.status(204).send())}),app.post("/repositories/:id/like",function(e,r){var t=e.params.id,i=repositories.find(function(e){return e.id===t});return i?(i.likes+=1,r.json(i)):r.status(400).send()}),module.exports=app;